<%= turbo_stream_from @chat %>
<style>
  /* hide websocket messages from myself */
  .message-conditional-hide[data-message-sender='<%= session_id %>'] {
    display: none;
  }
</style>

<div class="fixed bottom-3 right-14 bg-white text-blue-500 flex-1 p:2 sm:p-6 justify-between flex flex-col h-screen">
    <div class="flex sm:items-center justify-between py-3 border-b-2 border-gray-200">
      <div class="relative flex items-center space-x-4">
          <div class="flex flex-col leading-tight">
            <span class="text-lg text-gray-600">Support chat for</span>
            <div class="text-2xl mt-1 flex items-center">
                <span class="text-gray-700 mr-3"><%= @chat.user_name.titleize %></span>
            </div>

          </div>
      </div>
      <div class="flex items-center space-x-2">
          <button type="button" class="inline-flex items-center justify-center rounded-lg border h-10 w-10 transition duration-500 ease-in-out text-gray-500 hover:bg-gray-300 focus:outline-none">
          <%= heroicon "x-mark" %>
          </button>
      </div>
    </div>

    <div id="messages" class="flex flex-col space-y-4 p-3 overflow-y-auto scrollbar-thumb-blue scrollbar-thumb-rounded scrollbar-track-blue-lighter scrollbar-w-2 scrolling-touch">

      <% @chat.messages.each do |message| %>
        <% if message.is_mine?(self) %>
          <%= render partial: 'chat_messages_right', locals: { message: message } %>
        <% else %>
          <%= render partial: 'chat_messages_left', locals: { message: message } %>
        <% end %>
      <% end %>

    </div>
    <%= render partial: 'message_form', locals: { chat: @chat } %>
</div>
